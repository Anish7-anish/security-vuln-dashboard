(function(){"use strict";self.onmessage=async a=>{const{url:r}=a.data;console.log("👷 Worker started (yield-enabled):",r);try{const t=await fetch(r);if(!t.ok)throw new Error(`Failed to fetch JSON (${t.status})`);const n=await t.text(),c=JSON.parse(n);let s=0,o=[];for(const[i,l]of Object.entries(c.groups||{})){for(const[u,f]of Object.entries(l.repos||{}))for(const[g,p]of Object.entries(f.images||{})){const m=p.vulnerabilities||[];for(const e of m)e.id=e.id||`vuln-${s++}`,e.groupName=i,e.repoName=u,e.imageName=g,s<5&&console.log("🔎 Sample vuln:",{cve:e.cve,kaiStatus:e.kaiStatus,hasKey:Object.keys(e).includes("kaiStatus")}),o.push(e),o.length>=2e4&&(self.postMessage({type:"chunk",items:o}),o=[])}await new Promise(requestAnimationFrame)}o.length>0&&self.postMessage({type:"chunk",items:o}),console.log("🏁 Worker done. Total vulns:",s),self.postMessage({type:"done",count:s})}catch(t){console.error("❌ Worker error:",t),self.postMessage({type:"error",error:t.message})}}})();
